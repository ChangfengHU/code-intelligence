# 代码问答助手使用指南

## 🎯 功能概述

代码问答助手是一个基于AI的智能代码分析工具，能够：
- **深度代码分析**：自动分析选中代码的功能、实现原理和关键点
- **多轮问答**：支持连续对话，保持上下文记忆
- **智能会话管理**：基于类全限定路径的会话管理
- **PSI深度分析**：分析代码依赖关系和调用链

## 🚀 快速开始

### 1. 配置API Key
1. 打开 `Tools → Code Assistant → 代码翻译(AI)`
2. 在"AI服务提供商"中选择"OpenAI"
3. 填写你的OpenAI API Key
4. 设置模型（推荐：gpt-3.5-turbo 或 gpt-4）
5. 点击"Apply"保存配置

### 2. 开始对话
1. 在代码编辑器中选择一段代码
2. 右键点击选中的代码
3. 选择"代码对话 → 问答助手"
4. 等待AI自动分析代码
5. 在输入框中输入问题，开始多轮对话

## 💡 使用技巧

### 代码分析
- **选择关键代码**：选择包含核心逻辑的代码片段
- **包含上下文**：选择包含方法签名和关键变量的代码
- **避免过长**：选择100-500行的代码片段效果最佳

### 提问技巧
- **具体问题**：问具体的问题，如"这个方法的时间复杂度是多少？"
- **深入分析**：问"这段代码有什么潜在问题？"
- **设计模式**：问"这里使用了什么设计模式？"
- **优化建议**：问"如何优化这段代码？"

### 多轮对话
- **基于上下文**：AI会记住之前的对话内容
- **深入探讨**：可以针对AI的回答继续提问
- **代码改进**：可以要求AI提供改进建议

## ⚙️ 配置选项

### AI配置
- **系统提示词**：自定义AI的分析风格和重点
- **最大Token数**：控制AI响应的长度（推荐：4000）
- **Temperature**：控制AI回答的创造性（推荐：0.3）

### 会话管理
- **最大会话数**：默认100个会话（可配置）
- **每个会话最大消息数**：默认50次问答（可配置）
- **自动保存间隔**：默认30秒

### UI配置
- **对话框尺寸**：可配置宽度和高度
- **显示时间戳**：是否显示消息时间
- **启用代码高亮**：是否高亮显示代码
- **启动时显示历史记录**：是否自动加载历史消息

### 调试配置
- **显示AI交互详情**：显示AI请求和响应详情
- **启用调试模式**：显示调试面板

## 🔧 高级功能

### PSI分析
代码问答助手会自动分析：
- **类依赖关系**：分析字段类型、方法参数、返回值类型
- **调用链分析**：分析方法调用和构造函数调用
- **代码上下文**：获取完整的类代码和导入语句

### 会话管理
- **基于类路径**：每个类的全限定路径对应一个会话
- **历史记录**：自动保存对话历史
- **智能清理**：自动清理旧会话和消息

### 多语言支持
支持以下编程语言：
- Java/Kotlin：完整PSI分析
- Python：类和方法识别
- JavaScript/TypeScript：类和函数识别
- Go：结构体和方法识别
- C/C++：类和结构体识别

## 📋 使用场景

### 代码理解
- 理解复杂的业务逻辑
- 分析算法实现
- 理解设计模式应用

### 代码审查
- 发现潜在问题
- 检查代码质量
- 提供改进建议

### 学习辅助
- 学习新的编程概念
- 理解开源代码
- 掌握最佳实践

### 团队协作
- 代码解释和文档
- 知识分享
- 问题讨论

## 🚨 故障排除

### 常见问题

#### 1. 空白页面
**原因**：API Key未配置或配置错误
**解决**：
- 检查 `Tools → Code Assistant → 代码翻译(AI)` 中的API Key配置
- 确保API Key有效且有足够的额度

#### 2. 网络错误
**原因**：网络连接问题或代理设置
**解决**：
- 检查网络连接
- 配置正确的代理设置
- 检查防火墙设置

#### 3. AI响应慢
**原因**：网络延迟或模型选择
**解决**：
- 选择更快的模型（如gpt-3.5-turbo）
- 检查网络连接质量
- 减少代码长度

#### 4. 分析不准确
**原因**：代码选择不当或提示词问题
**解决**：
- 选择更完整的代码片段
- 自定义系统提示词
- 提供更具体的问题

### 调试模式
启用调试模式可以查看：
- AI请求和响应的详细信息
- 代码上下文分析结果
- 错误信息和堆栈跟踪

## 📞 技术支持

如果遇到问题：
1. 查看控制台输出和错误信息
2. 启用调试模式查看详细信息
3. 检查配置是否正确
4. 尝试重新配置API Key

## 🔮 未来功能

计划中的功能：
- 支持更多AI服务提供商
- 支持更多编程语言
- 代码重构建议
- 代码质量分析
- 团队协作功能

---

**注意**：使用前请确保已正确配置OpenAI API Key，并遵守相关使用条款。